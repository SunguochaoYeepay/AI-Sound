# AI-Sound 用户指南

本指南将帮助您了解如何使用 AI-Sound 系统进行文本到语音的转换，以及如何管理和配置系统。

## 目录

1. [系统概述](#系统概述)
2. [快速入门](#快速入门)
3. [Web 管理界面](#web-管理界面)
4. [高级功能](#高级功能)
5. [常见问题](#常见问题)

## 系统概述

AI-Sound 是一个整合多种 TTS（文本转语音）引擎的综合服务平台，支持多种 TTS 引擎的无缝切换和协同工作。系统通过统一的 API 接口和管理界面，为用户提供高质量的语音合成服务。

### 主要功能

- **多引擎文本转语音**：支持 MegaTTS3、ESPnet 等多种引擎
- **智能引擎选择**：根据文本特征自动选择最适合的引擎
- **批量处理**：支持批量文本转语音处理
- **声纹特征管理**：支持声纹特征提取和管理
- **Web 管理界面**：直观的任务和系统管理

## 快速入门

### 安装与配置

1. **系统要求**
   - Docker 20.10+
   - Docker Compose 2.0+
   - NVIDIA Container Toolkit (用于 GPU 支持)
   - 8+ 核 CPU，16GB+ 内存，NVIDIA GPU with 8GB+ VRAM (支持 CUDA)

2. **安装步骤**
   ```bash
   # 克隆代码库
   git clone https://github.com/your-org/ai-sound.git
   cd ai-sound
   
   # 创建共享网络
   ./services/create_network.sh  # Linux/Mac
   # 或
   services\create_network.bat  # Windows
   
   # 启动所有服务
   ./services/start_all_services.sh  # Linux/Mac
   # 或
   services\start_all_services.bat  # Windows
   ```

3. **访问服务**
   - Web 管理界面: http://localhost:8080
   - API 服务: http://localhost:9930

### 基本使用

#### 通过 Web 界面生成语音

1. 打开 Web 管理界面 (http://localhost:8080)
2. 登录系统（默认账户: admin / password）
3. 在"文本转语音"页面，输入要转换的文本
4. 选择所需的声音、情感和其他参数
5. 点击"生成"按钮
6. 等待处理完成后，可以在线预览或下载生成的音频

#### 通过 API 生成语音

使用 API 可以轻松地集成 AI-Sound 到您的应用中：

```python
import requests

# 基本合成请求
response = requests.post("http://localhost:9930/api/v1/synthesize", json={
    "text": "欢迎使用AI-Sound服务。",
    "voice_id": "female_001",
    "emotion": {
        "type": "happy",
        "intensity": 0.8
    },
    "engine_preference": "auto"  # 自动选择引擎
})

# 保存音频文件
with open("output.wav", "wb") as f:
    f.write(response.content)
```

详细的 API 文档请参阅 [API 参考](api_reference.md)。

## Web 管理界面

AI-Sound 提供了功能齐全的 Web 管理界面，方便用户进行各种操作和管理。

### 主要功能区域

1. **仪表盘**
   - 系统状态概览
   - 任务处理统计
   - 资源使用情况

2. **文本转语音**
   - 单文本处理
   - 批量文本处理
   - 参数调整与预览

3. **小说处理**
   - 小说文本上传
   - URL导入功能
   - 章节分割与管理
   - 角色声音映射

4. **音色管理**
   - 内置音色浏览
   - 自定义音色上传
   - 声纹特征提取
   - 音色预览与对比

5. **任务管理**
   - 任务队列查看
   - 任务状态监控
   - 结果下载与分享

6. **系统设置**
   - 引擎配置
   - 资源限制设置
   - 用户管理
   - API密钥管理

### 文本转语音流程

1. 导航到"文本转语音"页面
2. 输入文本或上传文本文件
3. 选择声音参数：
   - 声音ID：选择预设的声音
   - 情感类型：如快乐、悲伤、生气、中性等
   - 情感强度：调整情感表达的强度（0.0-1.0）
   - 语速：调整语音速度
   - 音高：调整语音音高
4. 选择引擎偏好（可选）：
   - 自动：系统自动选择最合适的引擎
   - MegaTTS3：偏向表现力和情感
   - ESPnet：偏向自然度和流畅性
5. 点击"生成"按钮处理文本
6. 处理完成后可以：
   - 在线预览音频
   - 下载音频文件
   - 调整参数重新生成

### 小说处理流程

1. 导航到"小说处理"页面
2. 选择导入方式：
   - 上传文本文件
   - 输入小说网址（自动爬取）
   - 直接粘贴文本内容
3. 配置处理选项：
   - 章节划分规则
   - 旁白音色
   - 角色声音映射
   - 输出格式和质量
4. 点击"开始处理"按钮
5. 在任务进度页面查看处理状态
6. 处理完成后可以：
   - 下载完整音频合集
   - 章节单独预览和下载
   - 调整配置重新处理部分章节

## 高级功能

### 声纹特征提取

AI-Sound 允许您从音频样本中提取声纹特征，创建自定义声音：

1. 导航到"音色管理"页面
2. 点击"上传新音色"按钮
3. 上传5-10秒的高质量音频样本
4. 填写音色信息（名称、描述、标签等）
5. 点击"提取特征"按钮
6. 系统会自动提取声纹特征并评估质量
7. 提取成功后，新音色会添加到您的音色库中

### 角色声音映射

处理小说时，可以为不同角色分配不同的声音：

1. 在"小说处理"页面，上传或输入小说内容
2. 系统会自动识别小说中的主要角色
3. 在"角色声音映射"部分，为每个角色选择合适的声音
4. 可以通过预览功能测试不同角色的声音效果
5. 确认无误后，点击"开始处理"按钮生成完整有声小说

### 批量处理

处理大量文本时，可以使用批量处理功能：

1. 导航到"批量处理"页面
2. 上传包含多段文本的CSV或JSON文件（按指定格式）
3. 配置默认参数和特定段落参数
4. 点击"提交批量任务"按钮
5. 系统会将任务加入队列并异步处理
6. 处理完成后，可以下载所有结果的压缩包

### API集成

AI-Sound 提供了全面的 API，方便与其他系统集成：

1. 在"系统设置"页面，生成 API 密钥
2. 使用 API 密钥调用 AI-Sound 的 API 接口
3. 可以通过 API 实现所有 Web 界面的功能
4. 支持同步（短文本）和异步（长文本）处理模式
5. 支持webhook回调，通知任务完成状态

详细的 API 文档请参阅 [API 参考](api_reference.md)。

## 常见问题

### 1. 系统性能问题

**问题**：语音生成速度较慢  
**解决方案**：
- 确保系统使用GPU加速
- 降低音频质量设置
- 使用批处理模式处理大量文本
- 考虑增加服务器资源配置

### 2. 音频质量问题

**问题**：生成的音频质量不佳  
**解决方案**：
- 尝试使用不同的TTS引擎
- 调整音频输出格式和比特率
- 确保原始文本格式正确，包含适当的标点
- 对于特定领域文本，选择专业领域的声音

### 3. 自定义声音问题

**问题**：自定义声音提取失败或质量差  
**解决方案**：
- 使用高质量的录音设备录制样本
- 确保录音环境安静，无背景噪音
- 录制时保持稳定的音量和语速
- 使用5-10秒的清晰语音样本
- 尝试多次提取并选择最佳结果

### 4. 小说处理问题

**问题**：小说角色识别不准确  
**解决方案**：
- 手动编辑系统识别的角色列表
- 使用更标准的引号格式标记对话
- 调整角色识别的敏感度设置
- 对于复杂小说，考虑使用手动标记模式

### 5. API连接问题

**问题**：API连接失败  
**解决方案**：
- 检查API密钥是否正确
- 确认服务器地址和端口配置
- 检查网络连接和防火墙设置
- 查看API请求限制是否已达上限

## 更多帮助

如需更多帮助，请参考以下资源：

- [常见问题解答](https://your-help-website.com/faq)
- [开发者论坛](https://your-forum-website.com)
- [技术支持邮箱](mailto:support@your-domain.com)

或者在 GitHub 上提交 [issue](https://github.com/your-org/ai-sound/issues)。