# 背景音生成模块文档

## 📁 目录说明

本目录包含AI-Sound项目背景音生成功能的设计文档和实施计划。

## 📋 文档列表

### 1. [腾讯SongGeneration集成设计方案.md](./腾讯SongGeneration集成设计方案.md)
**文档类型**：~~原技术设计方案（基于API调用）~~  
**状态**：已被本地部署方案取代

### 1.1. [腾讯SongGeneration本地部署集成方案.md](./腾讯SongGeneration本地部署集成方案.md) ⭐ **推荐**
**文档类型**：本地部署技术方案  
**内容概述**：
- 🏠 本地化部署优势分析
- 🐳 Docker容器化部署架构
- 🎵 本地音乐生成服务设计
- 🔧 AI-Sound后端集成方案
- 🚀 详细部署步骤和配置
- 📊 性能优化和监控指标
- ⚠️ 硬件要求和注意事项

### 2. [SongGeneration集成执行计划.md](./SongGeneration集成执行计划.md)
**文档类型**：项目执行计划  
**内容概述**：
- 📅 详细时间规划（10天计划）
- 📋 分阶段任务清单
- 🎯 关键成功指标（KSI）
- ⚠️ 风险控制计划
- 📊 资源需求分析
- 🏆 项目交付成果

## 🎯 项目概述

### 目标
将腾讯SongGeneration音乐生成引擎集成到AI-Sound项目，实现：
- 🎬 从"AI朗读器"升级到"AI音频电影制作工具"
- 🎵 基于小说情节自动生成匹配的背景音乐
- 🎛️ 多轨音频混音（对话+音乐+环境音）

### 核心技术方案
```
本地化AI音频制作链路：

小说文本输入
    ↓
[智能分析服务] → 角色识别 + 情节分析
    ↓
[TTS3本地服务] → 对话音频生成 (端口7861)
    ↓
[SongGeneration本地服务] → 背景音乐生成 (端口7862) ← 新增
    ↓  
[TangoFlux本地服务] → 环境音效生成 (端口7930)
    ↓
[多轨混音服务] → 最终音频输出
```

**本地部署优势：**
- 🏠 无网络依赖，数据隐私保护
- 🔧 与TTS3、TangoFlux架构一致
- 🐳 Docker容器化，易于部署管理
- ⚡ 低显存版本支持（<30GB显存）

### 集成亮点
- ✅ **规则驱动生成**：基于预设规则智能匹配音乐风格
- ✅ **无GPU冲突**：预先生成策略，无资源竞争问题
- ✅ **多轨专业混音**：电影级音频制作效果
- ✅ **用户完全可控**：独立调节各音轨音量

## 📊 技术架构

### 新增模块结构
```
platform/backend/app/services/
├── song_generation_service.py      # 本地SongGeneration服务调用
├── music_scene_analyzer.py         # 章节音乐分析
├── music_style_mapper.py           # 情节音乐映射
└── enhanced_audio_mixer.py         # 多轨混音增强

MegaTTS/
└── SongGeneration/                 # 新增音乐生成模块
    ├── song_generation_model.py    # 本地模型封装
    ├── music_input_generator.py    # 音乐输入生成器
    ├── audio_post_processor.py     # 音频后处理
    ├── server.py                   # HTTP服务封装
    ├── ckpt/                       # 模型权重目录
    └── requirements.txt            # Python依赖
```

### 多轨音频设计
```
轨道1：主对话 (TTS3输出，-6dB到0dB)
轨道2：背景音乐 (SongGeneration，-15dB到-8dB) ← 新增
轨道3：环境音底层 (TangoFlux，-20dB到-12dB)  
轨道4：音效层 (瞬间音效，-10dB到-3dB)
```

## 🚀 项目状态

**当前状态**：📋 设计完成，等待实施  
**预计工期**：6-8天  
**优先级**：🔥 高  

## 📞 联系信息

**项目负责团队**：AI-Sound开发团队  
**文档维护**：技术团队  
**最后更新**：2024年1月

---

> 💡 **提示**：在开始实施前，建议仔细阅读设计方案了解技术细节，然后按照执行计划的时间节点逐步推进。