import{u as B}from"./api-d479bee2.js";import{P as N}from"./PageHeader-2fef59b0.js";import{c as n,A as M,_ as L,d as E,l as G,S as x,R as U,L as q,r as p,o as F,e as w,f as J,w as r,g as i,j as a,n as V,t as d,p as z,i as C,k as R}from"./index-827e089e.js";import"./axios-3a665b0f.js";var Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM496 208H312c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 544h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H312c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm328 244a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"hdd",theme:"outlined"};const W=Q;function $(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),l.forEach(function(c){X(e,c,s[c])})}return e}function X(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var S=function(t,s){var l=$({},t,s.attrs);return n(M,$({},l,{icon:W}),null)};S.displayName="HddOutlined";S.inheritAttrs=!1;const Y=S;var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"};const K=Z;function D(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),l.forEach(function(c){tt(e,c,s[c])})}return e}function tt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var H=function(t,s){var l=D({},t,s.attrs);return n(M,D({},l,{icon:K}),null)};H.displayName="RocketOutlined";H.inheritAttrs=!1;const et=H;const st=E({name:"DashboardView",components:{PageHeader:N,DashboardOutlined:G,RocketOutlined:et,HddOutlined:Y,SoundOutlined:x,ReadOutlined:U,LoadingOutlined:q},setup(){const e=B(),t=p(!1),s=p(!1),l=p({gpu_available:!1,gpu_info:"未知",storage_used:"0 GB",storage_available:"0 GB"}),c=p({tts_count:0,novel_count:0,pending_tasks:0,audio_count:0}),h=p([]),y=[{title:"任务ID",dataIndex:"id",key:"id",width:220},{title:"任务类型",dataIndex:"type",key:"type",width:100},{title:"创建时间",dataIndex:"created_at",key:"created_at",width:160},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"操作",key:"action",width:100}],f=async()=>{s.value=!0;try{const o=await e.checkHealth();t.value=o.status==="ok"}catch(o){t.value=!1,console.error("API状态检查失败",o)}finally{s.value=!1}},u=async()=>{s.value=!0;try{l.value=await e.getSystemInfo()}catch(o){console.error("获取系统信息失败",o)}finally{s.value=!1}},m=async()=>{s.value=!0;try{c.value=await e.getStats()}catch(o){console.error("获取统计信息失败",o)}finally{s.value=!1}},g=async()=>{s.value=!0;try{h.value=await e.getRecentTasks(5)}catch(o){console.error("获取最近任务失败",o)}finally{s.value=!1}},_=o=>{console.log("查看任务详情",o)},v=o=>({pending:"blue",processing:"orange",completed:"green",failed:"red"})[o]||"default",b=o=>({pending:"等待中",processing:"处理中",completed:"已完成",failed:"失败"})[o]||o;return F(async()=>{await f(),t.value&&await Promise.all([u(),m(),g()]),setInterval(async()=>{await f(),t.value&&await Promise.all([u(),m(),g()])},6e4)}),{apiStatus:t,loading:s,systemInfo:l,stats:c,recentTasks:h,columns:y,showDetails:_,getStatusColor:v,getStatusText:b}}}),at={class:"dashboard"},nt={class:"status-wrapper"},ot={class:"status-item"},lt={class:"status-content"},it={class:"status-item"},ct={class:"status-content"},rt={class:"status-item"},dt={class:"status-content"},ut={class:"status-value"},_t={class:"stats-wrapper"},vt={class:"stats-item"},pt={class:"stats-content"},ft={class:"stats-value"},mt={class:"stats-item"},gt={class:"stats-content"},ht={class:"stats-value"},yt={class:"stats-item"},bt={class:"stats-content"},Ot={class:"stats-value"};function kt(e,t,s,l,c,h){const y=i("page-header"),f=i("dashboard-outlined"),u=i("a-divider"),m=i("rocket-outlined"),g=i("hdd-outlined"),_=i("a-card"),v=i("a-col"),b=i("sound-outlined"),o=i("read-outlined"),O=i("loading-outlined"),I=i("a-row"),j=i("a-tag"),T=i("a-button"),A=i("a-table");return w(),J("div",at,[n(y,{title:"系统控制台",subtitle:"MegaTTS3 系统状态与任务监控"}),n(I,{gutter:16},{default:r(()=>[n(v,{span:12},{default:r(()=>[n(_,{title:"系统状态"},{default:r(()=>[a("div",nt,[a("div",ot,[n(f),a("div",lt,[t[0]||(t[0]=a("div",{class:"status-title"},"API状态",-1)),a("div",{class:V(["status-value",e.apiStatus?"status-ok":"status-error"])},d(e.apiStatus?"运行中":"离线"),3)])]),n(u),a("div",it,[n(m),a("div",ct,[t[1]||(t[1]=a("div",{class:"status-title"},"GPU状态",-1)),a("div",{class:V(["status-value",e.systemInfo.gpu_available?"status-ok":"status-warning"])},d(e.systemInfo.gpu_available?"可用":"不可用"),3)])]),n(u),a("div",rt,[n(g),a("div",dt,[t[2]||(t[2]=a("div",{class:"status-title"},"存储空间",-1)),a("div",ut,d(e.systemInfo.storage_used)+" / "+d(e.systemInfo.storage_available),1)])])])]),_:1})]),_:1}),n(v,{span:12},{default:r(()=>[n(_,{title:"任务统计"},{default:r(()=>[a("div",_t,[a("div",vt,[n(b),a("div",pt,[t[3]||(t[3]=a("div",{class:"stats-title"},"语音合成数",-1)),a("div",ft,d(e.stats.tts_count),1)])]),n(u),a("div",mt,[n(o),a("div",gt,[t[4]||(t[4]=a("div",{class:"stats-title"},"小说处理数",-1)),a("div",ht,d(e.stats.novel_count),1)])]),n(u),a("div",yt,[n(O),a("div",bt,[t[5]||(t[5]=a("div",{class:"stats-title"},"待处理任务",-1)),a("div",Ot,d(e.stats.pending_tasks),1)])])])]),_:1})]),_:1})]),_:1}),n(I,{style:{"margin-top":"16px"}},{default:r(()=>[n(v,{span:24},{default:r(()=>[n(_,{title:"最近任务"},{default:r(()=>[n(A,{dataSource:e.recentTasks,columns:e.columns,pagination:!1,rowKey:"id",loading:e.loading},{bodyCell:r(({column:P,record:k})=>[P.key==="status"?(w(),z(j,{key:0,color:e.getStatusColor(k.status)},{default:r(()=>[C(d(e.getStatusText(k.status)),1)]),_:2},1032,["color"])):R("",!0),P.key==="action"?(w(),z(T,{key:1,type:"link",size:"small",onClick:wt=>e.showDetails(k.id)},{default:r(()=>t[6]||(t[6]=[C(" 查看详情 ")])),_:2,__:[6]},1032,["onClick"])):R("",!0)]),_:1},8,["dataSource","columns","loading"])]),_:1})]),_:1})]),_:1})])}const Vt=L(st,[["render",kt],["__scopeId","data-v-10f16035"]]);export{Vt as default};
