import{u as h}from"./api-d479bee2.js";import{_ as z,d as I,S as x,D as F,H as B,r as u,o as D,e as k,f as b,c as a,w as n,m as _,g as i,j as w,v as N,i as A,k as V,t as L}from"./index-827e089e.js";import"./axios-3a665b0f.js";const O=I({name:"AudioLibraryView",components:{SoundOutlined:x,DownloadOutlined:F,DeleteOutlined:B},setup(){h();const o=u([]),e=u(!0),y=u(!1),f=u(null),r=u(null),g=[{title:"文件名",dataIndex:"name",key:"name"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"时长",dataIndex:"duration",key:"duration"},{title:"文件大小",dataIndex:"size",key:"size",customRender:({text:t})=>`${(t/1024/1024).toFixed(2)} MB`},{title:"来源",dataIndex:"source",key:"source"},{title:"操作",key:"action"}],c=t=>{f.value=t,y.value=!0,setTimeout(()=>{r.value&&r.value.play().catch(l=>{console.error("音频自动播放失败:",l)})},300)},m=t=>{if(!t.url){_.error("下载链接不可用");return}const l=document.createElement("a");l.href=t.url,l.download=t.name,document.body.appendChild(l),l.click(),document.body.removeChild(l),_.success("已开始下载")},p=t=>{_.info(`删除音频: ${t.name} - 功能开发中`)},v=async()=>{e.value=!0;try{setTimeout(()=>{o.value=[{id:"audio_1",name:"三体-第一章.mp3",createTime:"2025-05-18 16:45:12",duration:"15:30",size:12345678,source:"小说批量生成",url:"https://example.com/audio/1.mp3"},{id:"audio_2",name:"三体-第二章.mp3",createTime:"2025-05-18 16:50:33",duration:"18:22",size:15678901,source:"小说批量生成",url:"https://example.com/audio/2.mp3"},{id:"audio_3",name:"测试单句.wav",createTime:"2025-05-17 10:12:55",duration:"0:12",size:1234567,source:"单句合成",url:"https://example.com/audio/3.wav"}],e.value=!1},1e3)}catch{_.error("加载音频列表失败"),e.value=!1}};return D(()=>{v()}),{audioFiles:o,columns:g,loading:e,playerVisible:y,currentAudio:f,audioPlayer:r,playAudio:c,downloadAudio:m,deleteAudio:p}}}),E={class:"audio-library"},M={class:"audio-player"},P=["src"];function j(o,e,y,f,r,g){const c=i("a-card"),m=i("a-col"),p=i("a-row"),v=i("sound-outlined"),t=i("a-button"),l=i("download-outlined"),$=i("delete-outlined"),T=i("a-table"),S=i("a-modal");return k(),b("div",E,[a(p,{gutter:16,class:"mb-16"},{default:n(()=>[a(m,{span:24},{default:n(()=>[a(c,{title:"音频库",bordered:!1},{default:n(()=>e[1]||(e[1]=[w("p",null,"管理和预览生成的音频文件",-1)])),_:1,__:[1]})]),_:1})]),_:1}),a(p,{gutter:16},{default:n(()=>[a(m,{span:24},{default:n(()=>[a(c,{title:"音频文件列表"},{default:n(()=>[a(T,{dataSource:o.audioFiles,columns:o.columns,pagination:{pageSize:10},loading:o.loading,rowKey:"id"},{bodyCell:n(({column:d,record:s})=>[d.key==="action"?(k(),b(N,{key:0},[a(t,{type:"link",onClick:C=>o.playAudio(s)},{default:n(()=>[a(v),e[2]||(e[2]=A(" 播放 "))]),_:2,__:[2]},1032,["onClick"]),a(t,{type:"link",onClick:C=>o.downloadAudio(s)},{default:n(()=>[a(l),e[3]||(e[3]=A(" 下载 "))]),_:2,__:[3]},1032,["onClick"]),a(t,{type:"link",danger:"",onClick:C=>o.deleteAudio(s)},{default:n(()=>[a($),e[4]||(e[4]=A(" 删除 "))]),_:2,__:[4]},1032,["onClick"])],64)):V("",!0)]),_:1},8,["dataSource","columns","loading"])]),_:1})]),_:1})]),_:1}),a(S,{visible:o.playerVisible,"onUpdate:visible":e[0]||(e[0]=d=>o.playerVisible=d),title:"音频播放器",footer:null,width:"500px"},{default:n(()=>{var d,s;return[w("div",M,[w("h3",null,L(((d=o.currentAudio)==null?void 0:d.name)||"未知音频"),1),(s=o.currentAudio)!=null&&s.url?(k(),b("audio",{key:0,ref:"audioPlayer",controls:"",style:{width:"100%"},src:o.currentAudio.url},null,8,P)):V("",!0)])]}),_:1},8,["visible"])])}const U=z(O,[["render",j],["__scopeId","data-v-58d80dcc"]]);export{U as default};
